<!DOCTYPE html>
<html>
  <head>
    <title>ABCD</title>
  </head>
  <body>
    <form onsubmit="saveToLocalStorage(event)">
      <label> Name</label>
      <input id='username'type="text" name="username" required/>
      <label>emailId</label>
      <input id='emailId'type="email" name="emailId" required/>
      <label> Phone Number</label>
      <input id='number'type="number" name="number"/>
      <button>Submit</button>
    </form>
    <ul id='listName'></ul>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.0.0-alpha.1/axios.min.js"></script>
    <script>
      
    function saveToLocalStorage(event){
       event.preventDefault();
        
          const name=event.target.username.value;
          const email=event.target.emailId.value;
          const phoneNumber=event.target.telephonenumber.value;
          const obj={
            name,
            email,
            phoneNumber
          };
        ;
        
        axios.get("https://localhost:300/admin/add-product",obj)
        .then((response)=>{
            //showNewUserOnScreen(response.data)
            console.log(response)})
            .catch((err)=>{console.log(err)})
       /* const name=event.target.username.value;
        const email=event.target.emailId.value;
        const phoneNumber=event.target.telephonenumber.value;*/
       /* localStorage.setItem('name', name);
        localStorage.setItem('email', email);
        localStorage.setItem('phonenumber', phoneNumber);*/
        
        // let myObj_serialized=JSON.stringify(myObj);
        
        // localStorage.setItem(myObj.email, myObj_serialized);
        // let myObj_deserialized=JSON.parse(localStorage.getItem('myObj'));
        // console.log(myObj_deserialized);
        showNewUserOnScreen(obj);
     }
 /*    window.addEventListener("DOMContentLoaded",()=>
     {
        axios.get("https://crudcrud.com/api/d6b2df914c024af19401a42548a1cfef/appointmentData1").then((response)=>{
            console.log(response)
            for(var i=0;i<response.data.length;i++){
                showNewUserOnScreen(response.data[i])
            }
        }).catch((err)=>{
            document.body.innerHTML="<h4>Something went wrong<h4>"
            console.log(err)})
     })*/
     function showNewUserOnScreen(user){
      const parentNode=document.getElementById('listName');
      console.log(parentNode);
      
      const childHTML=`<li id=${user._id}> ${user.name}-${user.email}<button onclick=editBtn('${user._id}','${user.name}','${user.email}','${user.phoneNumber}')>EDIT</button><button onclick=deleteUser('${user._id}')>DELETE</button</li>`;
      parentNode.innerHTML=parentNode.innerHTML+childHTML;
     }

     //add deleting fundamentals to delete button
     
     function deleteUser(Id){
    //    console.log(emailId)
    //     localStorage.removeItem(emailId);
    
        axios.delete(`https://crudcrud.com/api/d6b2df914c024af19401a42548a1cfef/appointmentData1/${Id}`).then((response)=>removeUserFromScreen(Id)).catch((err)=>console.log(err))
        // removeUserFromScreen(emailId);
        
      }
      function removeUserFromScreen(userId){
        const parentNode=document.getElementById('listName');
        const childNodeToBeRemoved=document.getElementById(userId);
        parentNode.removeChild(childNodeToBeRemoved);
      }
      //function to edit userdetails
     
      function editBtn(userId,editName,editEmail,editPhoneNumber){
        document.getElementById('username').value=editName;
        document.getElementById('emailId').value=editEmail;
        document.getElementById('telephonenumber').value=editPhoneNumber;

        

        deleteUser(userId);


//old[0]=newName;
// old[1]=newEmail;
}
</script>
</body>
</html>
